{% extends 'TapirBaseBundle::layout.html.twig' %}

{% block pagina_titulo %}{{ entitylabelplural }}{% endblock %}

{% set filtro_grupo = app.request.query.get('filtro_grupo') %}

{% block pagina_contenido %}

<table class="table table-hoverselect">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Documento</th>
            <th>Grupos</th>
        </tr>
    </thead>
    <tbody>
    {% for entity in entities %}
        <tr data-toggle="ajax-link" href="{{ path(baseroute ~ '_ver', arrastre|merge({ 'id': entity.id })) }}">
            <td>{{ entity.Apellido ~ ', ' ~ entity.Nombre }}</td>
            <td>{{ entity.DocumentoNumero }}</td>
            <td>{% for Nombre in entity.Grupos %}<span class="label label-info">{{ Nombre }}</span>&nbsp;{% endfor %}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>

{% endblock %}

{% block pagina_paginar %}{% include 'TapirBaseBundle::paginar.html.twig' %}{% endblock %}
{% block pagina_buscar %}{% set pagina_buscar_destino = path(baseroute ~ '_buscar', arrastre) %}{% include 'TapirBaseBundle::buscar.html.twig' %}{% endblock %}

{% block pagina_acciones %}
<div class="btn-group">
    <button class="btn btn-sm btn-default dropdown-toggle" type="button" id="dropdownMenuGrupos" data-toggle="dropdown">
        {% if not filtro_grupo %}
            Grupos
        {% else %}
            {% for grupo in personasgrupos %}
                {% if grupo.id == filtro_grupo %}{{ grupo.Nombre|tapir_abreviar }}{% endif %}
            {% endfor %}
        {% endif %}
        <span class="caret"></span>
    </button>
    <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuGrupos">
        <li role="presentation"><a data-toggle="ajax-link" role="menuitem" tabindex="-1" href="{{ path(baseroute ~ '_listar', arrastre|merge({ 'filtro_grupo': null, 'page': null })) }}">
            <i class="fa fa-fw{% if not filtro_grupo %} fa-check{% endif %}"></i>
            Todos</a></li>
        <li class="divider"></li>
        {% for grupo in personasgrupos %}
            <li role="presentation"><a data-toggle="ajax-link" role="menuitem" tabindex="-1" href="{{ path(baseroute ~ '_listar', arrastre|merge({ 'filtro_grupo': grupo.id, 'page': null })) }}">
                <i class="fa fa-fw{% if grupo.id == filtro_grupo %} fa-check{% endif %}"></i>
                {{ grupo.Nombre }}</a></li>
        {% endfor %}
    </ul>
</div>
{% endblock pagina_acciones %}

{% block pagina_acciones2 %}
    <a data-toggle="ajax-link" href="{{ path(baseroute ~ '_editar_1', arrastre) }}" class="btn btn-primary"><i class="fa fa-plus"></i> Alta de nueva persona</a>
{% endblock %}
